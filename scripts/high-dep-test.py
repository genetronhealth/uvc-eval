#!/usr/bin/env python
import gzip
import sys

# This script generates reads at the sequencing depth of ten millions with 50% allele fraction for EGFR exon19 DEL.
# Data generated by this script can be used to check that a variant-calling pipeline works as intended at extremely high sequencing depth.
# For example, integer overflow, memory exhaustion, intractable runtime, etc. should not occur.

def main():
    
    with gzip.open(sys.argv[1] + 'R1.fq.gz', 'wb', compresslevel=1) as r1file, gzip.open(sys.argv[1] + 'R2.fq.gz', 'wb', compresslevel=1) as r2file:
        for i in range(1000*1000*5//2):

            seqVTR1 = '''@7:55242400-55242500:VT:{}
CTCTCTCTGTCATAGGGACTCTGGATCCCAGAAGGTGAGAAAGTTCTTCCCGTCGCTATCAAGGAATTAAGAGAAGCAACATCTCCGAAAGCCAACA
+
FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
'''.format(i)

            seqWTR1 = '''@7:55242400-55242500:WT:{}
CTCTCTCTGTCATAGGGACTCTGGATCCCAGAAGGTGAGAAAGTTAAAATTCCCGTCGCTATCAAGGAATTAAGAGAAGCAACATCTCCGAAAGCCAACA
+
FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEEEEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
'''.format(i)

            # >7:55243400-55243500
            seqVTR2 = '''@7:55242400-55242500:VT:{}
AGCCAAGAAGGACAAAAGCCAGAGAGTAATATCCTCCGCCTCATGTCTAACCCACAGAATACATAGCAAGTAAAGAGAACATGGGCCTTTATAAAAATGT
+
FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
'''.format(i)

            # >7:55243400-55243500
            seqWTR2 = '''@7:55242400-55242500:WT:{}
AGCCAAGAAGGACAAAAGCCAGAGAGTAATATCCTCCGCCTCATGTCTAACCCACAGAATACATAGCAAGTAAAGAGAACATGGGCCTTTATAAAAATGT
+
FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
'''.format(i)
            
            if i % (100 * 1000) == 0: print('Processed ({} * 1000) iterations!'.format(i/1000))
            r1file.write(seqVTR1)
            r2file.write(seqVTR2)
            r1file.write(seqWTR1)
            r2file.write(seqWTR2)

if __name__ == '__main__':
    main()

